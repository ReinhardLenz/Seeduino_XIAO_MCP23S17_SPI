#include <Arduino.h>
#include <SPI.h>

#define CS_PIN 0   // XIAO D0

void writeRegister(uint8_t reg, uint8_t value) {
  digitalWrite(CS_PIN, LOW);
  SPI.transfer(0x40);   // MCP23S17 write, addr=0
  SPI.transfer(reg);
  SPI.transfer(value);
  digitalWrite(CS_PIN, HIGH);
}

void setup() {
  pinMode(CS_PIN, OUTPUT);
  digitalWrite(CS_PIN, HIGH);

  SPI.begin();
  SPI.beginTransaction(SPISettings(1000000, MSBFIRST, SPI_MODE0));

  // Set GPB0 and GPB1 as outputs
  writeRegister(0x01, 0b11111100);  // IODIRB (0=output)
}

void loop() {
  // LEDs ON (sink current)
  writeRegister(0x13, 0b00000000);  // GPIOB
  delay(500);

  // LEDs OFF
  writeRegister(0x13, 0b00000011);
  delay(500);
}
